## execute shell process
- hosts: sitserver
  tasks:
    - name: CHECK SPACE DETAILS
      shell: df -kh
      register: command_out
    
    - name: Format disk usage table
      shell: df -kh | awk 'NR==1{print $1"\t"$2"\t"$3"\t"$4"\t"$5"\t"$6} NR>1{print $1"\t"$2"\t"$3"\t"$4"\t"$5"\t"$6}' | column -t
      register: formatted_output
    
    - name: Send email
      mail:
        host: "mailrelay-prod.meta.spectrum.net"
        from: "Mobile2.0-DevOps <Mobile2.0-DevOps@charter.com>"
        to: "C-Venugopal.Velagani@charter.com,C-Sanket.Kurane@charter.com"
        subject: "Weekly Metrics Reports for Mediation Server Health Checks"
        body: |

          Hi All,
          Please find the Weekly Metrics Reports for Mediation Server Health Checks:
          {{ formatted_output.stdout }}
         
          Thanks,
          MDA-SRE Team.
      delegate_to: localhost
